  inventoryItems InventoryItem[]
  categoryBudgets CategoryBudget[]
  
  @@map("users")
}

model Business {
  id          String   @id @default(cuid())
  name        String
  description String?
  userId      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  user     User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  products Product[]
  
  @@map("businesses")
}

model Product {
  id               String   @id @default(cuid())
  name             String
  description      String?
  businessId       String
  hpp              Float    // Harga Pokok Penjualan
  targetMargin     Float    @default(0.3) // 30%
  currentPrice     Float?
  productionCost  Float    // Biaya produksi langsung
  laborCost       Float    // Biaya tenaga kerja
  overheadCost    Float    // Biaya overhead
  wasteFactor     Float    @default(0.05) // 5%
  unitProduction  Int      // Jumlah unit produksi
  category        String?
  sku             String?  @unique
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // Relations
  business    Business      @relation(fields: [businessId], references: [id], onDelete: Cascade)
  pricePoints PricePoint[]
  projections Projection[]
  inventoryItems InventoryItem[]
  sales       Sale[]
  
  @@map("products")
}

model PricePoint {
  id          String   @id @default(cuid())
  productId   String
  priceType   String   // competitive, standard, premium
  price       Float
  confidence  Float    // AI confidence score
  reasoning   String?  // AI reasoning
  createdAt   DateTime @default(now())
  
  // Relations
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  
  @@map("price_points")
}

model Projection {
  id              String   @id @default(cuid())
  productId       String
  userId          String
  targetProfit    Float    // Target laba %
  dailyVolume     Int      // Volume penjualan harian
  season          String   // peak, off-peak, normal
  projectedRevenue Float   // Proyeksi omzet
  breakEvenPoint  Float    // Break even point
  roi             Float    // Return on Investment
  cashFlow        Float    // Cash flow forecast
  sensitivity     Float?   // Hasil analisis sensitivitas
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // Relations
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("projections")
}

model InventoryItem {
  id          String   @id @default(cuid())
  productId   String
  userId      String
  itemName    String
  currentStock Int
  minStock    Int      // Minimum stock untuk reorder alert
  unitCost    Float
  lastUpdated DateTime @default(now())
  reorderAlert Boolean @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("inventory_items")
}

model CompetitorAnalysis {
  id          String   @id @default(cuid())
  productName String
  competitor  String
  price       Float
  rating      Float?
  reviewCount Int?
  sentiment   Float?   // Sentiment analysis score
  source      String   // tokopedia, shopee, etc.
  createdAt   DateTime @default(now())
  
  @@map("competitor_analysis")
}

model Sale {
  id          String   @id @default(cuid())
  productId   String
  quantity    Int
  totalPrice  Float
  date        DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  
  @@map("sales")
}

model CategoryBudget {
  id          String   @id @default(cuid())
  userId      String
  category    String
  amount      Float
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, category])
  @@map("category_budgets")
}